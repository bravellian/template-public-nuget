<Project>
  <!-- Single entry point for project-wide conventions. -->
  <PropertyGroup>
    <RepoRootPath>$([System.IO.Path]::GetFullPath('$(MSBuildThisFileDirectory)'))</RepoRootPath>
  </PropertyGroup>

  <PropertyGroup>
    <IsAnalyzerOrGenerator>false</IsAnalyzerOrGenerator>
    <IsAnalyzerOrGenerator Condition="'$(MSBuildProjectExtension)' == '.csproj' AND ($([System.String]::Copy('$(MSBuildProjectName)').StartsWith('Incursa.Generators')) OR $([System.String]::Copy('$(MSBuildProjectName)').StartsWith('Incursa.Analyzers')))">true</IsAnalyzerOrGenerator>

    <IsTestProject>false</IsTestProject>
    <IsTestProject Condition="'$(MSBuildProjectExtension)' == '.csproj' AND ($([System.String]::Copy('$(MSBuildProjectName)').EndsWith('Tests')) OR $([System.String]::Copy('$(MSBuildProjectName)').EndsWith('.Tests')))">true</IsTestProject>
  </PropertyGroup>

  <!-- Metadata first (all C# projects) -->
  <Import Project="metadata.props" Condition="'$(MSBuildProjectExtension)' == '.csproj'" />

  <!-- Analyzer/generator projects -->
  <Import Project="analyzers.props" Condition="'$(IsAnalyzerOrGenerator)' == 'true'" />

  <!-- Regular projects (includes tests) -->
  <Import Project="common.props" Condition="'$(MSBuildProjectExtension)' == '.csproj' AND '$(IsAnalyzerOrGenerator)' == 'false'" />
  <Import Project="tests.props" Condition="'$(MSBuildProjectExtension)' == '.csproj' AND '$(IsAnalyzerOrGenerator)' == 'false' AND '$(IsTestProject)' == 'true'" />
  <Import Project="non-tests.props" Condition="'$(MSBuildProjectExtension)' == '.csproj' AND '$(IsAnalyzerOrGenerator)' == 'false' AND '$(IsTestProject)' == 'false'" />

  <!-- Validation/analyzers for all non-analyzer projects -->
  <Import Project="strongvalidation.props" Condition="'$(MSBuildProjectExtension)' == '.csproj' AND '$(IsAnalyzerOrGenerator)' == 'false'" />
</Project>
